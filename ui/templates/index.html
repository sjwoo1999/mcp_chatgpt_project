<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>MCP μ—μ΄μ „νΈ μΈν„°νμ΄μ¤</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>π› οΈ MCP μ—μ΄μ „νΈ λ„κµ¬ μ‹¤ν–‰</h1>
    <p>μ•„λ λ²„νΌμ„ λλ¬ μ‹¤ν–‰ν•  λ„κµ¬λ¥Ό μ„ νƒν•μ„Έμ”.</p>

    <div class="button-group">
      <button onclick="selectTool('list')">list</button>
      <button onclick="selectTool('read')">read</button>
      <button onclick="selectTool('write')">write</button>
    </div>

    <div id="input-area" class="input-group" style="display:none;">
      <input id="arg1" type="text" placeholder="file_path μ…λ ¥">
      <input id="arg2" type="text" placeholder="λ‚΄μ© μ…λ ¥ (write μ „μ©)" style="display:none;">
    </div>

    <button id="run-btn" onclick="runTool()" style="display:none;">β–¶οΈ μ‹¤ν–‰</button>

    <div class="response">
      <h3>π“¤ κ²°κ³Ό μ‘λ‹µ</h3>
      <pre id="result" class="output-box"></pre>
    </div>
  </div>

  <script>
    let selectedTool = "list";

    function selectTool(tool) {
      selectedTool = tool;
      document.getElementById("input-area").style.display = (tool === "list") ? "none" : "block";
      document.getElementById("arg2").style.display = (tool === "write") ? "inline-block" : "none";
      document.getElementById("run-btn").style.display = "inline-block";
    }

    async function runTool() {
      const filePath = document.getElementById("arg1").value;
      const content = document.getElementById("arg2").value;
      const args = {};

      if (selectedTool === "read" || selectedTool === "write") args.path = filePath;
      if (selectedTool === "write") args.content = content;

      const res = await fetch("/ask", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ tool: selectedTool, args })
      });

      const data = await res.json();
      const box = document.getElementById("result");
      if (data.error) {
        box.textContent = `β μ¤λ¥: ${data.response}`;
        box.style.color = "red";
      } else {
        box.textContent = `β… κ²°κ³Ό:\n${data.response}`;
        box.style.color = "black";
      }
    }

    window.addEventListener("DOMContentLoaded", async () => {
        const res = await fetch("/server-status");
        const data = await res.json();
        if (!data.exists) {
            alert("β MCP μ„λ²„ νμΌμ΄ μ΅΄μ¬ν•μ§€ μ•μµλ‹λ‹¤. κ²½λ΅λ¥Ό ν™•μΈν•μ„Έμ”.");
        }
    });
  </script>
</body>
</html>
